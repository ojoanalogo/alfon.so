---
import { getCollection } from "astro:content";
import PostPreview from '../../components/PostPreview.astro';
import BaseLayout from '../../layouts/BaseLayout.astro';
import { sortMDByDate } from '../../utils';


const allPosts = await getCollection("blog");
const allPostsByDate = sortMDByDate(allPosts);
---

<BaseLayout title="Blog" navbarActiveItemID="blog">
  <section aria-label="Publicaciones de mi sitio" class="mt-6">
    <div
      class="bg-white/50 dark:bg-black/10 backdrop-blur-lg border border-gray-300/40 dark:border-gray-600/40 rounded-lg font-mono text-sm p-4 sm:p-6 transition-all duration-300 hover:border-gray-400/50 dark:hover:border-gray-400/30 hover:shadow-sm dark:hover:shadow-md dark:hover:shadow-black/20"
    >
      <h1 class="text-sm font-bold mb-4 text-muted">
        üìù Publicaciones
      </h1>

      {
        allPostsByDate.length === 0 ? (
        <div class="flex items-center gap-4 mb-6">
            <p class="text-4xl">üîç</p>
            <div class="flex flex-col">
              <h1 class="text-yellow-400 text-2xl font-bold">404</h1>
              <p class="text-muted text-xs">No hay publicaciones disponibles</p>
            </div>
          </div>
        ) : (
        <ul class="space-y-4 sm:space-y-2">
          {
            allPostsByDate.map((post) => (
              <li class="flex flex-col gap-x-2 sm:flex-row">
                <PostPreview post={post} />
              </li>
            ))
          }
        </ul>
        )
      }

      <div class="mt-3 pt-2 border-t border-gray-300 dark:border-gray-700 text-muted text-xs">
        <span class="text-secondary">$</span> ls -la blog/ | total {allPostsByDate.length}
      </div>
    </div>
  </section>
</BaseLayout>
